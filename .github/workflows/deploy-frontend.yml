name: Deploy Frontend to Vercel

on:
  push:
    branches: [ main ]
    paths:
      - 'store/**'
      - '.github/workflows/deploy-frontend.yml'
  workflow_dispatch:

jobs:
  deploy:
    name: Deploy to Vercel
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
    
    - name: Notify deployment start
      run: |
        echo "üöÄ Starting deployment to Vercel"
        echo "Commit: ${{ github.sha }}"
        echo "Author: ${{ github.actor }}"
    
    - name: Wait for Vercel auto-deploy
      run: |
        echo "‚è≥ Vercel will auto-deploy from GitHub"
        echo "Monitor at: https://vercel.com/dashboard"
        sleep 30
    
    - name: Deployment summary
      if: always()
      run: |
        echo "üìä Deployment Summary"
        echo "===================="
        echo "Status: ${{ job.status }}"
        echo "Check your Vercel dashboard for deployment URL"
        echo "API Backend: https://arch-backend-90c5.onrender.com/api"

  # Optional: If you want to use Vercel CLI for more control
  deploy-with-cli:
    name: Deploy with Vercel CLI (Optional)
    runs-on: ubuntu-latest
    if: false  # Set to true to enable
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Install Vercel CLI
      run: npm install -g vercel
    
    - name: Pull Vercel Environment
      working-directory: ./store
      run: vercel pull --yes --environment=production --token=${{ secrets.VERCEL_TOKEN }}
      if: env.VERCEL_TOKEN != ''
    
    - name: Build Project
      working-directory: ./store
      run: vercel build --prod --token=${{ secrets.VERCEL_TOKEN }}
      if: env.VERCEL_TOKEN != ''
    
    - name: Deploy to Vercel
      working-directory: ./store
      run: vercel deploy --prebuilt --prod --token=${{ secrets.VERCEL_TOKEN }}
      if: env.VERCEL_TOKEN != ''
